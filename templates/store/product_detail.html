{% extends 'store/base.html' %}

{% block title %}{{ product.name }} - My E-commerce Site{% endblock %}

{% block content %}
    <h2>{{ product.name }}</h2>
    <p>{{ product.description }}</p>
    <p>Price: ${{ product.price }}</p>
    
    <form method="post" action="{% url 'add_to_cart' product.id %}">
        {% csrf_token %}
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" name="quantity" value="1" min="1">
        <button type="submit" class="add-to-cart-btn">Add to Cart</button>
    </form>

    <h3>Average Rating: {{ average_rating }} / 5</h3>

    <h3>Reviews</h3>
    {% for review in reviews %}
        <div>
            <strong>{{ review.user.username }}</strong> rated it {{ review.rating }}/5
            <p>{{ review.comment }}</p>
            <p><small>Reviewed on {{ review.created_at }}</small></p>
        </div>
        <hr>
    {% empty %}
        <p>No reviews yet.</p>
    {% endfor %}

    <h3>Leave a Review</h3>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Submit Review</button>
    </form>

    <a href="{% url 'product_list' %}">Back to Products</a>
{% endblock %}
